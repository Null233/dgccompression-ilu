Mon Apr 11 19:50:55 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla V100-SXM2...  On   | 00000000:5F:00.0 Off |                    0 |
| N/A   29C    P0    40W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla V100-SXM2...  On   | 00000000:BE:00.0 Off |                    0 |
| N/A   29C    P0    40W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
/gs/software/cuda/10.1
[1,0]<stdout>:==> loading configs from ['configs/imagenet/vgg16_bn.py', 'configs/methods/wm0.py', 'configs/methods/fp16.py', 'configs/methods/int32.py']
[1,0]<stdout>:[train.save_path] = runs/[imagenet.vgg16_bn+methods.[wm0+fp16+int32]].np2
[1,0]<stdout>:[seed] = 42
[1,0]<stdout>:[data]
[1,0]<stdout>:  [num_threads_per_worker] = 4
[1,0]<stdout>:[train]
[1,0]<stdout>:  [dgc] = False
[1,0]<stdout>:  [compression]
[1,0]<stdout>:    [func] = <class 'src.compression.DGCCompressor'>
[1,0]<stdout>:    [compress_ratio] = 0.05
[1,0]<stdout>:    [sample_ratio] = 0.01
[1,0]<stdout>:    [strided_sample] = True
[1,0]<stdout>:    [compress_upper_bound] = 1.3
[1,0]<stdout>:    [compress_lower_bound] = 0.8
[1,0]<stdout>:    [max_adaptation_iters] = 10
[1,0]<stdout>:    [resample] = True
[1,0]<stdout>:    [memory]
[1,0]<stdout>:      [func] = <class 'src.memory.DGCSGDMemory'>
[1,0]<stdout>:      [momentum] = 0.9
[1,0]<stdout>:    [warmup_epochs] = 0
[1,0]<stdout>:    [fp16_values] = True
[1,0]<stdout>:    [int32_indices] = True
[1,0]<stdout>:  [criterion]
[1,0]<stdout>:    [func] = <class 'torch.nn.modules.loss.CrossEntropyLoss'>
[1,0]<stdout>:  [optimizer]
[1,0]<stdout>:    [func] = <class 'src.optim.sgd.DGCSGD'>
[1,0]<stdout>:    [momentum] = 0.9
[1,0]<stdout>:    [lr] = 0.0125
[1,0]<stdout>:    [weight_decay] = 5e-05
[1,0]<stdout>:  [schedule_lr_per_epoch] = True
[1,0]<stdout>:  [warmup_lr_epochs] = 5
[1,0]<stdout>:  [metric] = acc/test_top1
[1,0]<stdout>:  [meters]
[1,0]<stdout>:    [acc/{}_top1]
[1,0]<stdout>:      [func] = <class 'torchpack.mtpack.meters.class_meter.TopKClassMeter'>
[1,0]<stdout>:      [k] = 1
[1,0]<stdout>:    [acc/{}_top5]
[1,0]<stdout>:      [func] = <class 'torchpack.mtpack.meters.class_meter.TopKClassMeter'>
[1,0]<stdout>:      [k] = 5
[1,0]<stdout>:  [optimize_bn_separately] = False
[1,0]<stdout>:  [num_epochs] = 1
[1,0]<stdout>:  [batch_size] = 64
[1,0]<stdout>:  [scheduler]
[1,0]<stdout>:    [func] = <class 'torch.optim.lr_scheduler.MultiStepLR'>
[1,0]<stdout>:    [milestones] = [25, 55, 75]
[1,0]<stdout>:    [gamma] = 0.1
[1,0]<stdout>:  [topk] = True
[1,0]<stdout>:  [fp16] = False
[1,0]<stdout>:  [powersgd] = False
[1,0]<stdout>:  [sign] = False
[1,0]<stdout>:  [efsign] = False
[1,0]<stdout>:  [natural] = False
[1,0]<stdout>:  [onebit] = False
[1,0]<stdout>:  [qsgd] = False
[1,0]<stdout>:  [randomk] = False
[1,0]<stdout>:  [signum] = False
[1,0]<stdout>:  [terngrad] = False
[1,0]<stdout>:  [num_batches_per_step] = 1
[1,0]<stdout>:  [save_path] = runs/[imagenet.vgg16_bn+methods.[wm0+fp16+int32]].np2
[1,0]<stdout>:  [checkpoint_path] = runs/[imagenet.vgg16_bn+methods.[wm0+fp16+int32]].np2/checkpoints/e{epoch}-r0.pth
[1,0]<stdout>:  [latest_pth_path] = runs/[imagenet.vgg16_bn+methods.[wm0+fp16+int32]].np2/checkpoints/latest-r0.pth
[1,0]<stdout>:  [best_pth_path] = runs/[imagenet.vgg16_bn+methods.[wm0+fp16+int32]].np2/checkpoints/best-r0.pth
[1,0]<stdout>:[dataset]
[1,0]<stdout>:  [func] = <class 'torchpack.mtpack.datasets.vision.imagenet.ImageNet'>
[1,0]<stdout>:  [root] = /gs/home/lwang20/jzb_horovod_test/deep-gradient-compression/data/imagenet
[1,0]<stdout>:  [num_classes] = 1000
[1,0]<stdout>:  [image_size] = 224
[1,0]<stdout>:[model]
[1,0]<stdout>:  [func] = <function vgg16_bn at 0x7f0478e22ee0>
[1,0]<stdout>:  [num_classes] = 1000
[1,0]<stdout>:  [init_weights] = True
[1,0]<stdout>:[device] = cuda[1,0]<stdout>:
[1,0]<stdout>:
[1,0]<stdout>:==> creating model "[func] = <function vgg16_bn at 0x7f0478e22ee0>
[1,0]<stdout>:[num_classes] = 1000
[1,0]<stdout>:[init_weights] = True"
[1,0]<stdout>:
[1,0]<stdout>:==> creating dataset "[func] = <class 'torchpack.mtpack.datasets.vision.imagenet.ImageNet'>
[1,0]<stdout>:[root] = /gs/home/lwang20/jzb_horovod_test/deep-gradient-compression/data/imagenet
[1,0]<stdout>:[num_classes] = 1000
[1,0]<stdout>:[image_size] = 224"
[1,0]<stdout>:
[1,0]<stdout>:==> loading dataset "{'num_workers': 4, 'pin_memory': True, 'multiprocessing_context': 'forkserver'}""
[1,0]<stdout>:
[1,0]<stdout>:==> creating optimizer "[func] = <class 'src.optim.sgd.DGCSGD'>
[1,0]<stdout>:[momentum] = 0.9
[1,0]<stdout>:[lr] = 0.025
[1,0]<stdout>:[weight_decay] = 5e-05"
[1,0]<stdout>:
[1,0]<stdout>:==> creating compression "[func] = <class 'src.compression.DGCCompressor'>
[1,0]<stdout>:[compress_ratio] = 0.05
[1,0]<stdout>:[sample_ratio] = 0.01
[1,0]<stdout>:[strided_sample] = True
[1,0]<stdout>:[compress_upper_bound] = 1.3
[1,0]<stdout>:[compress_lower_bound] = 0.8
[1,0]<stdout>:[max_adaptation_iters] = 10
[1,0]<stdout>:[resample] = True
[1,0]<stdout>:[memory]
[1,0]<stdout>:  [func] = <class 'src.memory.DGCSGDMemory'>
[1,0]<stdout>:  [momentum] = 0.9
[1,0]<stdout>:[warmup_epochs] = 0
[1,0]<stdout>:[fp16_values] = True
[1,0]<stdout>:[int32_indices] = True"
[1,0]<stdout>:
[1,0]<stdout>:==> initializing topk compression
[1,0]<stdout>:
[1,0]<stdout>:==> train from scratch
[1,0]<stdout>:
[1,0]<stdout>:==> broadcasting paramters and optimizer state
[1,0]<stdout>:before evaluate
[1,1]<stdout>:before evaluate
[1,0]<stderr>:test:   0%|          | 0/79 [00:00<?, ?it/s][1,1]<stderr>:test:   0%|          | 0/79 [00:00<?, ?it/s][1,0]<stderr>:test:   1%|▏         | 1/79 [00:08<10:26,  8.03s/it][1,1]<stderr>:test:   1%|▏         | 1/79 [00:08<10:37,  8.17s/it][1,0]<stderr>:test:   6%|▋         | 5/79 [00:10<02:12,  1.80s/it][1,1]<stderr>:test:   6%|▋         | 5/79 [00:11<02:14,  1.82s/it][1,0]<stderr>:test:   8%|▊         | 6/79 [00:11<01:45,  1.44s/it][1,1]<stderr>:test:   9%|▉         | 7/79 [00:11<01:24,  1.18s/it][1,1]<stderr>:test:  11%|█▏        | 9/79 [00:13<01:24,  1.21s/it][1,0]<stderr>:test:  11%|█▏        | 9/79 [00:13<01:22,  1.18s/it][1,0]<stderr>:test:  13%|█▎        | 10/79 [00:14<01:10,  1.03s/it][1,1]<stderr>:test:  14%|█▍        | 11/79 [00:15<01:10,  1.04s/it][1,1]<stderr>:test:  16%|█▋        | 13/79 [00:16<01:04,  1.02it/s][1,0]<stderr>:test:  16%|█▋        | 13/79 [00:17<01:05,  1.00it/s][1,0]<stderr>:test:  18%|█▊        | 14/79 [00:17<00:56,  1.15it/s][1,1]<stderr>:test:  19%|█▉        | 15/79 [00:18<01:00,  1.05it/s][1,1]<stderr>:test:  22%|██▏       | 17/79 [00:20<00:54,  1.15it/s][1,1]<stderr>:test:  23%|██▎       | 18/79 [00:20<00:47,  1.29it/s][1,0]<stderr>:test:  22%|██▏       | 17/79 [00:20<00:58,  1.05it/s][1,0]<stderr>:test:  23%|██▎       | 18/79 [00:21<00:55,  1.10it/s][1,1]<stderr>:test:  24%|██▍       | 19/79 [00:21<00:53,  1.13it/s][1,1]<stderr>:test:  27%|██▋       | 21/79 [00:23<00:49,  1.17it/s][1,1]<stderr>:test:  28%|██▊       | 22/79 [00:23<00:40,  1.42it/s][1,0]<stderr>:test:  27%|██▋       | 21/79 [00:23<00:49,  1.16it/s][1,0]<stderr>:test:  28%|██▊       | 22/79 [00:24<00:46,  1.22it/s][1,1]<stderr>:test:  29%|██▉       | 23/79 [00:24<00:42,  1.32it/s][1,1]<stderr>:test:  32%|███▏      | 25/79 [00:26<00:45,  1.20it/s][1,1]<stderr>:test:  33%|███▎      | 26/79 [00:26<00:39,  1.34it/s][1,0]<stderr>:test:  32%|███▏      | 25/79 [00:26<00:45,  1.18it/s][1,0]<stderr>:test:  33%|███▎      | 26/79 [00:27<00:40,  1.31it/s][1,1]<stderr>:test:  34%|███▍      | 27/79 [00:27<00:43,  1.20it/s][1,1]<stderr>:test:  37%|███▋      | 29/79 [00:28<00:33,  1.48it/s][1,1]<stderr>:test:  38%|███▊      | 30/79 [00:29<00:34,  1.41it/s][1,0]<stderr>:test:  37%|███▋      | 29/79 [00:29<00:38,  1.30it/s][1,0]<stderr>:test:  38%|███▊      | 30/79 [00:30<00:35,  1.37it/s][1,1]<stderr>:test:  39%|███▉      | 31/79 [00:30<00:38,  1.25it/s][1,1]<stderr>:test:  42%|████▏     | 33/79 [00:31<00:32,  1.40it/s][1,0]<stderr>:test:  42%|████▏     | 33/79 [00:32<00:37,  1.23it/s][1,0]<stderr>:test:  43%|████▎     | 34/79 [00:33<00:31,  1.41it/s][1,1]<stderr>:test:  43%|████▎     | 34/79 [00:33<00:38,  1.18it/s][1,1]<stderr>:test:  44%|████▍     | 35/79 [00:33<00:32,  1.37it/s][1,1]<stderr>:test:  47%|████▋     | 37/79 [00:34<00:23,  1.75it/s][1,0]<stderr>:test:  47%|████▋     | 37/79 [00:35<00:32,  1.31it/s][1,0]<stderr>:test:  48%|████▊     | 38/79 [00:35<00:27,  1.51it/s][1,1]<stderr>:test:  48%|████▊     | 38/79 [00:36<00:37,  1.09it/s][1,1]<stderr>:test:  49%|████▉     | 39/79 [00:36<00:29,  1.38it/s][1,1]<stderr>:test:  52%|█████▏    | 41/79 [00:36<00:20,  1.85it/s][1,0]<stderr>:test:  52%|█████▏    | 41/79 [00:38<00:28,  1.35it/s][1,0]<stderr>:test:  54%|█████▍    | 43/79 [00:39<00:24,  1.49it/s][1,1]<stderr>:test:  53%|█████▎    | 42/79 [00:39<00:36,  1.00it/s][1,1]<stderr>:test:  54%|█████▍    | 43/79 [00:39<00:29,  1.20it/s][1,1]<stderr>:test:  57%|█████▋    | 45/79 [00:40<00:24,  1.38it/s][1,0]<stderr>:test:  57%|█████▋    | 45/79 [00:42<00:31,  1.07it/s][1,0]<stderr>:test:  59%|█████▉    | 47/79 [00:42<00:22,  1.41it/s][1,1]<stderr>:test:  58%|█████▊    | 46/79 [00:43<00:36,  1.11s/it][1,1]<stderr>:test:  62%|██████▏   | 49/79 [00:45<00:24,  1.21it/s][1,0]<stderr>:test:  62%|██████▏   | 49/79 [00:45<00:28,  1.06it/s][1,0]<stderr>:test:  63%|██████▎   | 50/79 [00:46<00:23,  1.23it/s][1,0]<stderr>:test:  65%|██████▍   | 51/79 [00:46<00:22,  1.23it/s][1,1]<stderr>:test:  63%|██████▎   | 50/79 [00:46<00:30,  1.05s/it][1,1]<stderr>:test:  67%|██████▋   | 53/79 [00:47<00:18,  1.41it/s][1,0]<stderr>:test:  67%|██████▋   | 53/79 [00:48<00:21,  1.23it/s][1,0]<stderr>:test:  70%|██████▉   | 55/79 [00:49<00:16,  1.43it/s][1,1]<stderr>:test:  68%|██████▊   | 54/79 [00:49<00:22,  1.12it/s][1,1]<stderr>:test:  72%|███████▏  | 57/79 [00:51<00:16,  1.36it/s][1,0]<stderr>:test:  72%|███████▏  | 57/79 [00:51<00:18,  1.17it/s][1,1]<stderr>:test:  73%|███████▎  | 58/79 [00:52<00:17,  1.21it/s][1,1]<stderr>:test:  76%|███████▌  | 60/79 [00:52<00:11,  1.63it/s][1,0]<stderr>:test:  75%|███████▍  | 59/79 [00:53<00:16,  1.22it/s][1,1]<stderr>:test:  77%|███████▋  | 61/79 [00:53<00:11,  1.57it/s][1,0]<stderr>:test:  77%|███████▋  | 61/79 [00:54<00:14,  1.28it/s][1,1]<stderr>:test:  78%|███████▊  | 62/79 [00:55<00:15,  1.09it/s][1,0]<stderr>:test:  80%|███████▉  | 63/79 [00:56<00:12,  1.32it/s][1,1]<stderr>:test:  82%|████████▏ | 65/79 [00:56<00:08,  1.66it/s][1,0]<stderr>:test:  82%|████████▏ | 65/79 [00:57<00:09,  1.42it/s][1,1]<stderr>:test:  84%|████████▎ | 66/79 [00:58<00:11,  1.13it/s][1,1]<stderr>:test:  87%|████████▋ | 69/79 [00:58<00:05,  1.74it/s][1,0]<stderr>:test:  85%|████████▍ | 67/79 [00:59<00:09,  1.24it/s][1,0]<stderr>:test:  87%|████████▋ | 69/79 [01:00<00:07,  1.33it/s][1,1]<stderr>:test:  89%|████████▊ | 70/79 [01:01<00:07,  1.16it/s][1,1]<stderr>:test:  91%|█████████ | 72/79 [01:01<00:04,  1.54it/s][1,1]<stderr>:test:  92%|█████████▏| 73/79 [01:01<00:03,  1.80it/s][1,0]<stderr>:test:  90%|████████▉ | 71/79 [01:02<00:06,  1.16it/s][1,0]<stderr>:test:  92%|█████████▏| 73/79 [01:03<00:04,  1.38it/s][1,1]<stderr>:test:  94%|█████████▎| 74/79 [01:04<00:04,  1.09it/s][1,1]<stderr>:test:  96%|█████████▌| 76/79 [01:04<00:01,  1.58it/s][1,1]<stderr>:test:  97%|█████████▋| 77/79 [01:05<00:01,  1.54it/s][1,0]<stderr>:test:  95%|█████████▍| 75/79 [01:05<00:03,  1.17it/s][1,0]<stderr>:test:  97%|█████████▋| 77/79 [01:06<00:01,  1.55it/s][1,0]<stderr>:test: 100%|██████████| 79/79 [01:06<00:00,  1.19it/s][1,1]<stderr>:test:  99%|█████████▊| 78/79 [01:06<00:00,  1.07it/s][1,1]<stderr>:test: 100%|██████████| 79/79 [01:06<00:00,  1.18it/s][1,1]<stdout>:after evaluate
[1,0]<stdout>:after evaluate
[1,0]<stdout>:[acc/test_top1] = 0.060000
[1,0]<stdout>:[acc/test_top5] = 0.560000
[1,1]<stderr>:
[1,0]<stdout>:
[1,0]<stdout>:==> training epoch 0/1
[1,0]<stderr>:
[1,0]<stderr>:train:   0% 0/255 [00:00<?, ?it/s][1,1]<stderr>:Traceback (most recent call last):
[1,1]<stderr>:  File "./train.py", line 556, in <module>
[1,1]<stderr>:    main()
[1,1]<stderr>:  File "./train.py", line 287, in main
[1,1]<stderr>:    train(model=model, loader=loaders['train'],
[1,1]<stderr>:  File "./train.py", line 377, in train
[1,1]<stderr>:    total1 += time2 - time1
[1,1]<stderr>:UnboundLocalError: local variable 'total1' referenced before assignment
[1,0]<stderr>:train:   0% 0/255 [00:23<?, ?it/s][1,0]<stderr>:
[1,0]<stderr>:Traceback (most recent call last):
[1,0]<stderr>:  File "./train.py", line 556, in <module>
[1,0]<stderr>:    main()
[1,0]<stderr>:  File "./train.py", line 287, in main
[1,0]<stderr>:    train(model=model, loader=loaders['train'],
[1,0]<stderr>:  File "./train.py", line 377, in train
[1,0]<stderr>:    total1 += time2 - time1
[1,0]<stderr>:UnboundLocalError: local variable 'total1' referenced before assignment
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[64936,1],1]
  Exit code:    1
--------------------------------------------------------------------------

real	2m32.349s
user	1m15.654s
sys	0m8.650s
